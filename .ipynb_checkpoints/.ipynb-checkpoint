{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.decomposition import PCA\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "from sklearn.metrics import accuracy_score"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# data cleaning"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "data = pd.read_csv(\"mushrooms.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>class</th>\n",
       "      <th>cap-shape</th>\n",
       "      <th>cap-surface</th>\n",
       "      <th>cap-color</th>\n",
       "      <th>bruises</th>\n",
       "      <th>odor</th>\n",
       "      <th>gill-attachment</th>\n",
       "      <th>gill-spacing</th>\n",
       "      <th>gill-size</th>\n",
       "      <th>gill-color</th>\n",
       "      <th>...</th>\n",
       "      <th>stalk-surface-below-ring</th>\n",
       "      <th>stalk-color-above-ring</th>\n",
       "      <th>stalk-color-below-ring</th>\n",
       "      <th>veil-type</th>\n",
       "      <th>veil-color</th>\n",
       "      <th>ring-number</th>\n",
       "      <th>ring-type</th>\n",
       "      <th>spore-print-color</th>\n",
       "      <th>population</th>\n",
       "      <th>habitat</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>p</td>\n",
       "      <td>x</td>\n",
       "      <td>s</td>\n",
       "      <td>n</td>\n",
       "      <td>t</td>\n",
       "      <td>p</td>\n",
       "      <td>f</td>\n",
       "      <td>c</td>\n",
       "      <td>n</td>\n",
       "      <td>k</td>\n",
       "      <td>...</td>\n",
       "      <td>s</td>\n",
       "      <td>w</td>\n",
       "      <td>w</td>\n",
       "      <td>p</td>\n",
       "      <td>w</td>\n",
       "      <td>o</td>\n",
       "      <td>p</td>\n",
       "      <td>k</td>\n",
       "      <td>s</td>\n",
       "      <td>u</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>e</td>\n",
       "      <td>x</td>\n",
       "      <td>s</td>\n",
       "      <td>y</td>\n",
       "      <td>t</td>\n",
       "      <td>a</td>\n",
       "      <td>f</td>\n",
       "      <td>c</td>\n",
       "      <td>b</td>\n",
       "      <td>k</td>\n",
       "      <td>...</td>\n",
       "      <td>s</td>\n",
       "      <td>w</td>\n",
       "      <td>w</td>\n",
       "      <td>p</td>\n",
       "      <td>w</td>\n",
       "      <td>o</td>\n",
       "      <td>p</td>\n",
       "      <td>n</td>\n",
       "      <td>n</td>\n",
       "      <td>g</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>e</td>\n",
       "      <td>b</td>\n",
       "      <td>s</td>\n",
       "      <td>w</td>\n",
       "      <td>t</td>\n",
       "      <td>l</td>\n",
       "      <td>f</td>\n",
       "      <td>c</td>\n",
       "      <td>b</td>\n",
       "      <td>n</td>\n",
       "      <td>...</td>\n",
       "      <td>s</td>\n",
       "      <td>w</td>\n",
       "      <td>w</td>\n",
       "      <td>p</td>\n",
       "      <td>w</td>\n",
       "      <td>o</td>\n",
       "      <td>p</td>\n",
       "      <td>n</td>\n",
       "      <td>n</td>\n",
       "      <td>m</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>p</td>\n",
       "      <td>x</td>\n",
       "      <td>y</td>\n",
       "      <td>w</td>\n",
       "      <td>t</td>\n",
       "      <td>p</td>\n",
       "      <td>f</td>\n",
       "      <td>c</td>\n",
       "      <td>n</td>\n",
       "      <td>n</td>\n",
       "      <td>...</td>\n",
       "      <td>s</td>\n",
       "      <td>w</td>\n",
       "      <td>w</td>\n",
       "      <td>p</td>\n",
       "      <td>w</td>\n",
       "      <td>o</td>\n",
       "      <td>p</td>\n",
       "      <td>k</td>\n",
       "      <td>s</td>\n",
       "      <td>u</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>e</td>\n",
       "      <td>x</td>\n",
       "      <td>s</td>\n",
       "      <td>g</td>\n",
       "      <td>f</td>\n",
       "      <td>n</td>\n",
       "      <td>f</td>\n",
       "      <td>w</td>\n",
       "      <td>b</td>\n",
       "      <td>k</td>\n",
       "      <td>...</td>\n",
       "      <td>s</td>\n",
       "      <td>w</td>\n",
       "      <td>w</td>\n",
       "      <td>p</td>\n",
       "      <td>w</td>\n",
       "      <td>o</td>\n",
       "      <td>e</td>\n",
       "      <td>n</td>\n",
       "      <td>a</td>\n",
       "      <td>g</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 23 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "  class cap-shape cap-surface cap-color bruises odor gill-attachment  \\\n",
       "0     p         x           s         n       t    p               f   \n",
       "1     e         x           s         y       t    a               f   \n",
       "2     e         b           s         w       t    l               f   \n",
       "3     p         x           y         w       t    p               f   \n",
       "4     e         x           s         g       f    n               f   \n",
       "\n",
       "  gill-spacing gill-size gill-color  ... stalk-surface-below-ring  \\\n",
       "0            c         n          k  ...                        s   \n",
       "1            c         b          k  ...                        s   \n",
       "2            c         b          n  ...                        s   \n",
       "3            c         n          n  ...                        s   \n",
       "4            w         b          k  ...                        s   \n",
       "\n",
       "  stalk-color-above-ring stalk-color-below-ring veil-type veil-color  \\\n",
       "0                      w                      w         p          w   \n",
       "1                      w                      w         p          w   \n",
       "2                      w                      w         p          w   \n",
       "3                      w                      w         p          w   \n",
       "4                      w                      w         p          w   \n",
       "\n",
       "  ring-number ring-type spore-print-color population habitat  \n",
       "0           o         p                 k          s       u  \n",
       "1           o         p                 n          n       g  \n",
       "2           o         p                 n          n       m  \n",
       "3           o         p                 k          s       u  \n",
       "4           o         e                 n          a       g  \n",
       "\n",
       "[5 rows x 23 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "class                       0\n",
       "cap-shape                   0\n",
       "cap-surface                 0\n",
       "cap-color                   0\n",
       "bruises                     0\n",
       "odor                        0\n",
       "gill-attachment             0\n",
       "gill-spacing                0\n",
       "gill-size                   0\n",
       "gill-color                  0\n",
       "stalk-shape                 0\n",
       "stalk-root                  0\n",
       "stalk-surface-above-ring    0\n",
       "stalk-surface-below-ring    0\n",
       "stalk-color-above-ring      0\n",
       "stalk-color-below-ring      0\n",
       "veil-type                   0\n",
       "veil-color                  0\n",
       "ring-number                 0\n",
       "ring-type                   0\n",
       "spore-print-color           0\n",
       "population                  0\n",
       "habitat                     0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "class                        2\n",
       "cap-shape                    6\n",
       "cap-surface                  4\n",
       "cap-color                   10\n",
       "bruises                      2\n",
       "odor                         9\n",
       "gill-attachment              2\n",
       "gill-spacing                 2\n",
       "gill-size                    2\n",
       "gill-color                  12\n",
       "stalk-shape                  2\n",
       "stalk-root                   5\n",
       "stalk-surface-above-ring     4\n",
       "stalk-surface-below-ring     4\n",
       "stalk-color-above-ring       9\n",
       "stalk-color-below-ring       9\n",
       "veil-type                    1\n",
       "veil-color                   4\n",
       "ring-number                  3\n",
       "ring-type                    5\n",
       "spore-print-color            9\n",
       "population                   6\n",
       "habitat                      7\n",
       "dtype: int64"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.nunique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "data=data.drop(\"veil-type\",axis=1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Preprocesing"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>class</th>\n",
       "      <th>cap-shape</th>\n",
       "      <th>cap-surface</th>\n",
       "      <th>cap-color</th>\n",
       "      <th>bruises</th>\n",
       "      <th>odor</th>\n",
       "      <th>gill-attachment</th>\n",
       "      <th>gill-spacing</th>\n",
       "      <th>gill-size</th>\n",
       "      <th>gill-color</th>\n",
       "      <th>...</th>\n",
       "      <th>stalk-surface-above-ring</th>\n",
       "      <th>stalk-surface-below-ring</th>\n",
       "      <th>stalk-color-above-ring</th>\n",
       "      <th>stalk-color-below-ring</th>\n",
       "      <th>veil-color</th>\n",
       "      <th>ring-number</th>\n",
       "      <th>ring-type</th>\n",
       "      <th>spore-print-color</th>\n",
       "      <th>population</th>\n",
       "      <th>habitat</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>p</td>\n",
       "      <td>x</td>\n",
       "      <td>s</td>\n",
       "      <td>n</td>\n",
       "      <td>t</td>\n",
       "      <td>p</td>\n",
       "      <td>f</td>\n",
       "      <td>c</td>\n",
       "      <td>n</td>\n",
       "      <td>k</td>\n",
       "      <td>...</td>\n",
       "      <td>s</td>\n",
       "      <td>s</td>\n",
       "      <td>w</td>\n",
       "      <td>w</td>\n",
       "      <td>w</td>\n",
       "      <td>o</td>\n",
       "      <td>p</td>\n",
       "      <td>k</td>\n",
       "      <td>s</td>\n",
       "      <td>u</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>e</td>\n",
       "      <td>x</td>\n",
       "      <td>s</td>\n",
       "      <td>y</td>\n",
       "      <td>t</td>\n",
       "      <td>a</td>\n",
       "      <td>f</td>\n",
       "      <td>c</td>\n",
       "      <td>b</td>\n",
       "      <td>k</td>\n",
       "      <td>...</td>\n",
       "      <td>s</td>\n",
       "      <td>s</td>\n",
       "      <td>w</td>\n",
       "      <td>w</td>\n",
       "      <td>w</td>\n",
       "      <td>o</td>\n",
       "      <td>p</td>\n",
       "      <td>n</td>\n",
       "      <td>n</td>\n",
       "      <td>g</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>e</td>\n",
       "      <td>b</td>\n",
       "      <td>s</td>\n",
       "      <td>w</td>\n",
       "      <td>t</td>\n",
       "      <td>l</td>\n",
       "      <td>f</td>\n",
       "      <td>c</td>\n",
       "      <td>b</td>\n",
       "      <td>n</td>\n",
       "      <td>...</td>\n",
       "      <td>s</td>\n",
       "      <td>s</td>\n",
       "      <td>w</td>\n",
       "      <td>w</td>\n",
       "      <td>w</td>\n",
       "      <td>o</td>\n",
       "      <td>p</td>\n",
       "      <td>n</td>\n",
       "      <td>n</td>\n",
       "      <td>m</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>p</td>\n",
       "      <td>x</td>\n",
       "      <td>y</td>\n",
       "      <td>w</td>\n",
       "      <td>t</td>\n",
       "      <td>p</td>\n",
       "      <td>f</td>\n",
       "      <td>c</td>\n",
       "      <td>n</td>\n",
       "      <td>n</td>\n",
       "      <td>...</td>\n",
       "      <td>s</td>\n",
       "      <td>s</td>\n",
       "      <td>w</td>\n",
       "      <td>w</td>\n",
       "      <td>w</td>\n",
       "      <td>o</td>\n",
       "      <td>p</td>\n",
       "      <td>k</td>\n",
       "      <td>s</td>\n",
       "      <td>u</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>e</td>\n",
       "      <td>x</td>\n",
       "      <td>s</td>\n",
       "      <td>g</td>\n",
       "      <td>f</td>\n",
       "      <td>n</td>\n",
       "      <td>f</td>\n",
       "      <td>w</td>\n",
       "      <td>b</td>\n",
       "      <td>k</td>\n",
       "      <td>...</td>\n",
       "      <td>s</td>\n",
       "      <td>s</td>\n",
       "      <td>w</td>\n",
       "      <td>w</td>\n",
       "      <td>w</td>\n",
       "      <td>o</td>\n",
       "      <td>e</td>\n",
       "      <td>n</td>\n",
       "      <td>a</td>\n",
       "      <td>g</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "  class cap-shape cap-surface cap-color bruises odor gill-attachment  \\\n",
       "0     p         x           s         n       t    p               f   \n",
       "1     e         x           s         y       t    a               f   \n",
       "2     e         b           s         w       t    l               f   \n",
       "3     p         x           y         w       t    p               f   \n",
       "4     e         x           s         g       f    n               f   \n",
       "\n",
       "  gill-spacing gill-size gill-color  ... stalk-surface-above-ring  \\\n",
       "0            c         n          k  ...                        s   \n",
       "1            c         b          k  ...                        s   \n",
       "2            c         b          n  ...                        s   \n",
       "3            c         n          n  ...                        s   \n",
       "4            w         b          k  ...                        s   \n",
       "\n",
       "  stalk-surface-below-ring stalk-color-above-ring stalk-color-below-ring  \\\n",
       "0                        s                      w                      w   \n",
       "1                        s                      w                      w   \n",
       "2                        s                      w                      w   \n",
       "3                        s                      w                      w   \n",
       "4                        s                      w                      w   \n",
       "\n",
       "  veil-color ring-number ring-type spore-print-color population habitat  \n",
       "0          w           o         p                 k          s       u  \n",
       "1          w           o         p                 n          n       g  \n",
       "2          w           o         p                 n          n       m  \n",
       "3          w           o         p                 k          s       u  \n",
       "4          w           o         e                 n          a       g  \n",
       "\n",
       "[5 rows x 22 columns]"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "class                        2\n",
       "cap-shape                    6\n",
       "cap-surface                  4\n",
       "cap-color                   10\n",
       "bruises                      2\n",
       "odor                         9\n",
       "gill-attachment              2\n",
       "gill-spacing                 2\n",
       "gill-size                    2\n",
       "gill-color                  12\n",
       "stalk-shape                  2\n",
       "stalk-root                   5\n",
       "stalk-surface-above-ring     4\n",
       "stalk-surface-below-ring     4\n",
       "stalk-color-above-ring       9\n",
       "stalk-color-below-ring       9\n",
       "veil-color                   4\n",
       "ring-number                  3\n",
       "ring-type                    5\n",
       "spore-print-color            9\n",
       "population                   6\n",
       "habitat                      7\n",
       "dtype: int64"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.nunique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "data_1=pd.get_dummies(data,drop_first=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>class_p</th>\n",
       "      <th>cap-shape_c</th>\n",
       "      <th>cap-shape_f</th>\n",
       "      <th>cap-shape_k</th>\n",
       "      <th>cap-shape_s</th>\n",
       "      <th>cap-shape_x</th>\n",
       "      <th>cap-surface_g</th>\n",
       "      <th>cap-surface_s</th>\n",
       "      <th>cap-surface_y</th>\n",
       "      <th>cap-color_c</th>\n",
       "      <th>...</th>\n",
       "      <th>population_n</th>\n",
       "      <th>population_s</th>\n",
       "      <th>population_v</th>\n",
       "      <th>population_y</th>\n",
       "      <th>habitat_g</th>\n",
       "      <th>habitat_l</th>\n",
       "      <th>habitat_m</th>\n",
       "      <th>habitat_p</th>\n",
       "      <th>habitat_u</th>\n",
       "      <th>habitat_w</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 96 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   class_p  cap-shape_c  cap-shape_f  cap-shape_k  cap-shape_s  cap-shape_x  \\\n",
       "0        1            0            0            0            0            1   \n",
       "1        0            0            0            0            0            1   \n",
       "2        0            0            0            0            0            0   \n",
       "3        1            0            0            0            0            1   \n",
       "4        0            0            0            0            0            1   \n",
       "\n",
       "   cap-surface_g  cap-surface_s  cap-surface_y  cap-color_c  ...  \\\n",
       "0              0              1              0            0  ...   \n",
       "1              0              1              0            0  ...   \n",
       "2              0              1              0            0  ...   \n",
       "3              0              0              1            0  ...   \n",
       "4              0              1              0            0  ...   \n",
       "\n",
       "   population_n  population_s  population_v  population_y  habitat_g  \\\n",
       "0             0             1             0             0          0   \n",
       "1             1             0             0             0          1   \n",
       "2             1             0             0             0          0   \n",
       "3             0             1             0             0          0   \n",
       "4             0             0             0             0          1   \n",
       "\n",
       "   habitat_l  habitat_m  habitat_p  habitat_u  habitat_w  \n",
       "0          0          0          0          1          0  \n",
       "1          0          0          0          0          0  \n",
       "2          0          1          0          0          0  \n",
       "3          0          0          0          1          0  \n",
       "4          0          0          0          0          0  \n",
       "\n",
       "[5 rows x 96 columns]"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_1.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(8124, 96)"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_1.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "y=data_1[\"class_p\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "x=data_1.drop(\"class_p\",axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    1\n",
       "1    0\n",
       "2    0\n",
       "3    1\n",
       "4    0\n",
       "Name: class_p, dtype: uint8"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>cap-shape_c</th>\n",
       "      <th>cap-shape_f</th>\n",
       "      <th>cap-shape_k</th>\n",
       "      <th>cap-shape_s</th>\n",
       "      <th>cap-shape_x</th>\n",
       "      <th>cap-surface_g</th>\n",
       "      <th>cap-surface_s</th>\n",
       "      <th>cap-surface_y</th>\n",
       "      <th>cap-color_c</th>\n",
       "      <th>cap-color_e</th>\n",
       "      <th>...</th>\n",
       "      <th>population_n</th>\n",
       "      <th>population_s</th>\n",
       "      <th>population_v</th>\n",
       "      <th>population_y</th>\n",
       "      <th>habitat_g</th>\n",
       "      <th>habitat_l</th>\n",
       "      <th>habitat_m</th>\n",
       "      <th>habitat_p</th>\n",
       "      <th>habitat_u</th>\n",
       "      <th>habitat_w</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 95 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   cap-shape_c  cap-shape_f  cap-shape_k  cap-shape_s  cap-shape_x  \\\n",
       "0            0            0            0            0            1   \n",
       "1            0            0            0            0            1   \n",
       "2            0            0            0            0            0   \n",
       "3            0            0            0            0            1   \n",
       "4            0            0            0            0            1   \n",
       "\n",
       "   cap-surface_g  cap-surface_s  cap-surface_y  cap-color_c  cap-color_e  ...  \\\n",
       "0              0              1              0            0            0  ...   \n",
       "1              0              1              0            0            0  ...   \n",
       "2              0              1              0            0            0  ...   \n",
       "3              0              0              1            0            0  ...   \n",
       "4              0              1              0            0            0  ...   \n",
       "\n",
       "   population_n  population_s  population_v  population_y  habitat_g  \\\n",
       "0             0             1             0             0          0   \n",
       "1             1             0             0             0          1   \n",
       "2             1             0             0             0          0   \n",
       "3             0             1             0             0          0   \n",
       "4             0             0             0             0          1   \n",
       "\n",
       "   habitat_l  habitat_m  habitat_p  habitat_u  habitat_w  \n",
       "0          0          0          0          1          0  \n",
       "1          0          0          0          0          0  \n",
       "2          0          1          0          0          0  \n",
       "3          0          0          0          1          0  \n",
       "4          0          0          0          0          0  \n",
       "\n",
       "[5 rows x 95 columns]"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [],
   "source": [
    "x_train, x_test, y_train, y_test = train_test_split( x, y, test_size=0.2, random_state=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [],
   "source": [
    "x_train, x_valid, y_train, y_valid = train_test_split( x_train, y_train, test_size=0.2, random_state=0)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "nie potrzebujemy skalować danych ponieważ mamy wartości 0-1, można by ewentualnie pomyśleć o normalizacji ale no nie wiem czu jest to mi potrzebne"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "5 0.47820012127754236\n",
      "10 0.6369973771058285\n",
      "15 0.7359770836054526\n",
      "20 0.8103237670400342\n",
      "25 0.8648788441445959\n",
      "30 0.9082386423261564\n",
      "35 0.9398767586865723\n",
      "40 0.9623613953999461\n",
      "45 0.9776022188810661\n",
      "50 0.9858261727875598\n",
      "55 0.9911398918655598\n"
     ]
    }
   ],
   "source": [
    "for i in range(1,12):\n",
    "    pca = PCA(n_components=i*5)\n",
    "    pca.fit(x_train)\n",
    "    print(i*5, pca.explained_variance_ratio_.sum())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "dwa podejścia z (patrz w górę) i bez"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "PCA(copy=True, iterated_power='auto', n_components=40, random_state=None,\n",
       "    svd_solver='auto', tol=0.0, whiten=False)"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pca = PCA(n_components=40)\n",
    "pca.fit(x_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [],
   "source": [
    "x_train_pca=pca.transform(x_train)\n",
    "x_valid_pca=pca.transform(x_valid)\n",
    "x_test_pca=pca.transform(x_test)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Model training and validation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "3 gini auto 0.933076923076923\n",
      "3 gini None 0.9761538461538461\n",
      "3 entropy auto 0.963076923076923\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "3 entropy None 0.9838461538461538\n",
      "4 gini auto 0.9807692307692307\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "4 gini None 0.9869230769230769\n",
      "4 entropy auto 0.9407692307692308\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "4 entropy None 0.9861538461538462\n",
      "5 gini auto 0.9830769230769231\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "5 gini None 0.9892307692307692\n",
      "5 entropy auto 0.9907692307692307\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "5 entropy None 0.9892307692307692\n",
      "6 gini auto 0.9938461538461538\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "6 gini None 0.9907692307692307\n",
      "6 entropy auto 0.9938461538461538\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "6 entropy None 0.9976923076923077\n",
      "7 gini auto 0.9953846153846154\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "7 gini None 0.9915384615384616\n",
      "7 entropy auto 0.9969230769230769\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "7 entropy None 0.9992307692307693\n",
      "8 gini auto 0.9984615384615385\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "8 gini None 0.9923076923076923\n",
      "8 entropy auto 0.9984615384615385\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "8 entropy None 0.9992307692307693\n",
      "9 gini auto 1.0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "9 gini None 0.9953846153846154\n",
      "9 entropy auto 0.9992307692307693\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "9 entropy None 0.9976923076923077\n",
      "10 gini auto 0.9969230769230769\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "10 gini None 0.9946153846153846\n",
      "10 entropy auto 0.9984615384615385\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "10 entropy None 0.9976923076923077\n",
      "11 gini auto 1.0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "11 gini None 0.9961538461538462\n",
      "11 entropy auto 1.0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "11 entropy None 0.9992307692307693\n",
      "12 gini auto 1.0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "12 gini None 0.9953846153846154\n",
      "12 entropy auto 0.9992307692307693\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "12 entropy None 0.9984615384615385\n",
      "13 gini auto 0.9984615384615385\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "13 gini None 0.9961538461538462\n",
      "13 entropy auto 0.9992307692307693\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "13 entropy None 1.0\n",
      "14 gini auto 1.0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "14 gini None 0.9953846153846154\n",
      "14 entropy auto 1.0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "14 entropy None 0.9984615384615385\n",
      "15 gini auto 0.9984615384615385\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "15 gini None 0.9946153846153846\n",
      "15 entropy auto 0.9992307692307693\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "15 entropy None 0.9984615384615385\n",
      "16 gini auto 1.0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "16 gini None 0.9953846153846154\n",
      "16 entropy auto 1.0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "16 entropy None 0.9984615384615385\n",
      "17 gini auto 1.0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "17 gini None 0.9953846153846154\n",
      "17 entropy auto 0.9992307692307693\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "17 entropy None 0.9976923076923077\n",
      "18 gini auto 0.9992307692307693\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "18 gini None 0.9953846153846154\n",
      "18 entropy auto 0.9984615384615385\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "18 entropy None 0.9984615384615385\n",
      "19 gini auto 0.9992307692307693\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "19 gini None 0.9946153846153846\n",
      "19 entropy auto 0.9992307692307693\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n",
      "D:\\Anaconda\\lib\\site-packages\\sklearn\\ensemble\\forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.\n",
      "  \"10 in version 0.20 to 100 in 0.22.\", FutureWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "19 entropy None 0.9984615384615385\n"
     ]
    }
   ],
   "source": [
    "Best_model=None\n",
    "Best_score=0\n",
    "for n in range(3,20):\n",
    "    for c in [\"gini\",\"entropy\"]:\n",
    "        for mf in [\"auto\",None]:\n",
    "            clf = RandomForestClassifier(max_depth=n, criterion=c, max_features=mf)\n",
    "            clf.fit(x_train_pca, y_train)\n",
    "            y_pred=clf.predict(x_valid_pca)\n",
    "            score=accuracy_score(y_valid,y_pred)\n",
    "            print(n, c, mf, score)\n",
    "            if score>Best_score:\n",
    "                Best_model=clf\n",
    "                Best_score= score\n",
    "            "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1.0\n"
     ]
    }
   ],
   "source": [
    "print(Best_score)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [],
   "source": [
    "y_pred=Best_model.predict(x_test_pca)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.9993846153846154"
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "accuracy_score(y_test,y_pred)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "metadata": {},
   "outputs": [],
   "source": [
    "y_score=Best_model.predict_proba(x_test_pca)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import sklearn.metrics as metrics\n",
    "preds = y_score[:,1]\n",
    "fpr, tpr, threshold = metrics.roc_curve(y_test, preds)\n",
    "roc_auc = metrics.auc(fpr, tpr)\n",
    "\n",
    "# method I: plt\n",
    "import matplotlib.pyplot as plt\n",
    "plt.title('Receiver Operating Characteristic')\n",
    "plt.plot(fpr, tpr, 'b', label = 'AUC = %0.2f' % roc_auc)\n",
    "plt.legend(loc = 'lower right')\n",
    "plt.plot([0, 1], [0, 1],'r--')\n",
    "plt.xlim([0, 1])\n",
    "plt.ylim([0, 1])\n",
    "plt.ylabel('True Positive Rate')\n",
    "plt.xlabel('False Positive Rate')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Testing and analysing relusts"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
